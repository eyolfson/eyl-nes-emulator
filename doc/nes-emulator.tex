% Copyright 2016 Jonathan Eyolfson
%
% This work is licensed under a Creative Commons Attribution-ShareAlike 4.0
% International License. You should have received a copy of the license along
% with this work. If not, see <http://creativecommons.org/licenses/by-sa/4.0/>.

\documentclass[10pt, draft]{book}

\usepackage{amsmath}
\usepackage{fontspec}
\usepackage[a5paper, bindingoffset=10mm, inner=20mm, outer=20mm]{geometry}
\usepackage{tikz}

\setmainfont[Ligatures=TeX]{Tinos}
\setsansfont{Arimo}[Scale=MatchLowercase]
\setmonofont{Cousine}[Scale=MatchLowercase]

\definecolor{solarizedBase03}{RGB}{0, 43, 54}
\definecolor{solarizedBase0}{RGB}{131, 148, 150}
\definecolor{solarizedBlue}{RGB}{38, 139, 210}

\usetikzlibrary{arrows, automata, decorations.pathreplacing, positioning}

\begin{document}

  \begin{titlepage}
    \begin{tikzpicture}[remember picture, overlay]
      \draw[draw=none, fill=solarizedBase03]
        (current page.north west) rectangle (current page.south east);
      \node[color=solarizedBlue, text width=1.75cm, text centered, scale=8]
        (title) at (current page.center) {\texttt{NES Emulator}};
      \node[anchor=south west, inner sep=4mm, color=solarizedBase0, scale=2]
        at (current page.south west) {\textsf{0.0.1-development}};
      \node[anchor=south east, inner sep=4mm, color=solarizedBase0, scale=2]
        at (current page.south east) {\textsf{Jonathan Eyolfson}};
    \end{tikzpicture}
  \end{titlepage}

  \tableofcontents

  \chapter{Introduction}

  Console layout.

  \chapter{CPU}

  The NES CPU is a modified 6502. It is an 8-bit CPU. It has an accumlator
  register (A), two index registers (X and Y). It has a register for the
  processor status flag bits (P). It has an 8-bit stack pointer (S) which is
  256 bytes large and always starts with address $(\texttt{01})_{16}$. The
  program counter (PC) is 16-bit.

  \section{Stack}

  The stack exists at $(\texttt{0100})_{16}$ to $(\texttt{01FF})_{16}$.
  Initially the stack pointer is set to $(\texttt{01FD})_{16}$
  ($(\texttt{FD})_{16}$ in the stack pointer register). This means the stack is
  256 bytes large.

  The stack is a descending stack, which means it grows downward. The stack is
  also an ``empty stack''. This means the element the stack pointer is pointing
  to is free to use.

  \begin{tikzpicture}
    \draw (0, 0) rectangle (2, 0.5);
    \draw (0, 0.5) rectangle (2, 1);
    \draw (0, 1) rectangle (2, 1.5);
    \draw (0, 1.5) rectangle (2, 2);
  \end{tikzpicture}

  \section{Instructions}

  This sequence of instructions:

  \texttt{LDA \#\$0xFF}

  \texttt{PHA}

  \texttt{PLP}

  \noindent Results in \texttt{P} being set to $(\texttt{EF})_{16}$ and not
  $(\texttt{FF})_{16}$? Why? Do the \texttt{N} and \texttt{Z} flags get set
  based off the current value of \texttt{A} and not from the stack?

  \section{Interrupts}

  \chapter{PPU}

  Screen resolution is $256 \times 240$ pixels.
  Tiles are $8 \times 8$, $8 \times 16$, or $16 \times 8$ pixels.
  There are $64$ possible colours.

  \section{Memory}

  \section{Object Attribute Memory (OAM)}

  \section{Registers}

  \section{Drawing a Pixel}

  \subsection{Background}

  \subsection{Sprite}

  \section{Vertical Blanking Interval}

  Also known as: \texttt{VBLANK}

  \chapter{APU}

\end{document}
